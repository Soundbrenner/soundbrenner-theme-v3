{% assign hero_card_fallback_image_desktop = 'hero-card-placeholder-desktop.jpg' | asset_url %}
{% assign hero_card_fallback_image_mobile = 'hero-card-placeholder-mobile.jpg' | asset_url %}
{% assign hero_card_use_seasonal = section.settings.use_seasonal_hero_card %}
{% assign hero_card_app_store_link = 'https://apps.apple.com/us/app/the-metronome-by-soundbrenner/id1048954353' %}
{% assign hero_card_google_play_link = 'https://play.google.com/store/apps/details?id=com.soundbrenner.pulse' %}
{% assign hero_card_china_download_link = 'https://files.soundbrenner.com/downloads/TheMetronome.apk' %}

{% if hero_card_use_seasonal %}
  {% assign hero_card_source_image_desktop = settings.seasonal_hero_image_desktop %}
  {% assign hero_card_source_image_mobile = settings.seasonal_hero_image_mobile %}
  {% assign hero_card_kicker = settings.seasonal_hero_kicker %}
  {% assign hero_card_headline = settings.seasonal_hero_headline %}
  {% assign hero_card_subheadline = settings.seasonal_hero_subheadline %}
  {% assign hero_card_button_label = settings.seasonal_hero_button_label %}
  {% assign hero_card_button_link = settings.seasonal_hero_button_link %}
  {% if hero_card_button_label != blank %}
    {% assign hero_card_show_button = true %}
  {% else %}
    {% assign hero_card_show_button = false %}
  {% endif %}
{% else %}
  {% assign hero_card_source_image_desktop = section.settings.background_image_desktop %}
  {% assign hero_card_source_image_mobile = section.settings.background_image_mobile %}
  {% assign hero_card_kicker = section.settings.kicker %}
  {% assign hero_card_headline = section.settings.headline %}
  {% assign hero_card_subheadline = section.settings.subheadline %}
  {% assign hero_card_button_label = section.settings.button_label %}
  {% assign hero_card_button_link = section.settings.button_link %}
  {% assign hero_card_show_button = section.settings.show_button %}
  {% if hero_card_show_button and hero_card_button_label == blank %}
    {% assign hero_card_button_label = 'Placeholder' %}
  {% endif %}
{% endif %}

{% if hero_card_source_image_mobile != blank %}
  {% assign hero_card_mobile_request_width = hero_card_source_image_mobile.width | at_most: 1206 %}
  {% assign hero_card_mobile_image = hero_card_source_image_mobile | image_url: width: hero_card_mobile_request_width %}
{% else %}
  {% assign hero_card_mobile_image = hero_card_fallback_image_mobile %}
{% endif %}
{% if hero_card_source_image_desktop != blank %}
  {% assign hero_card_desktop_image = hero_card_source_image_desktop | image_url: width: 2480 %}
{% else %}
  {% assign hero_card_desktop_image = hero_card_fallback_image_desktop %}
{% endif %}

<div class="sb-hero-card-section" data-sb-reveal>
  <div
    class="sb-framing-card"
    data-sb-reveal-item
    style="--sb-hero-card-bg-mobile: url('{{ hero_card_mobile_image }}'); --sb-hero-card-bg-desktop: url('{{ hero_card_desktop_image }}');"
  >
    <div class="sb-framing-card__content">
      {% if hero_card_kicker != blank %}
        <p class="sb-framing-card__kicker font-body weight-semibold">{{ hero_card_kicker }}</p>
      {% endif %}
      {% if hero_card_headline != blank %}
        <h2 class="sb-framing-card__headline font-title weight-bold">{{ hero_card_headline }}</h2>
      {% endif %}
      {% if hero_card_subheadline != blank %}
        <p class="sb-framing-card__subheadline font-body weight-semibold">{{ hero_card_subheadline }}</p>
      {% endif %}
      {% if hero_card_show_button %}
        {% render 'radiant-button',
          label: hero_card_button_label,
          link: hero_card_button_link,
          size: section.settings.button_size,
          icon_position: section.settings.icon_position,
          extra_class: 'sb-framing-card__button'
        %}
      {% endif %}

      {% if section.settings.enable_app_download_buttons %}
        <div class="sb-framing-card__app-downloads">
          <div class="sb-framing-card__app-downloads-qr" aria-hidden="true">
            <img
              src="{{ 'app-download-qr-metronome-app.png' | asset_url }}"
              alt=""
              loading="lazy"
              width="80"
              height="80"
            >
          </div>

          <a class="sb-framing-card__app-download-link" href="{{ hero_card_app_store_link }}">
            <img
              class="sb-framing-card__app-download-badge sb-framing-card__app-download-badge--app-store"
              src="{{ 'app-download-app-store.png' | asset_url }}"
              alt="Download on the App Store"
              loading="lazy"
            >
          </a>

          <a class="sb-framing-card__app-download-link" href="{{ hero_card_google_play_link }}">
            <img
              class="sb-framing-card__app-download-badge sb-framing-card__app-download-badge--google-play"
              src="{{ 'app-download-google-play.png' | asset_url }}"
              alt="Get it on Google Play"
              loading="lazy"
            >
          </a>

          <a class="sb-framing-card__app-download-link" href="{{ hero_card_china_download_link }}">
            <img
              class="sb-framing-card__app-download-badge sb-framing-card__app-download-badge--china"
              src="{{ 'app-download-china.png' | asset_url }}"
              alt="Download in China"
              loading="lazy"
            >
          </a>
        </div>
      {% endif %}
    </div>
  </div>
</div>

{% stylesheet %}
  .sb-framing-card {
    --sb-hero-bg-focus-mobile: 50%;
    --sb-hero-bg-focus-desktop: 75%;
    align-items: flex-start;
    background: var(--sb-color-neutral-200);
    background-image: var(--sb-hero-card-bg-mobile);
    background-position: var(--sb-hero-bg-focus-mobile) center;
    background-repeat: no-repeat;
    background-size: cover;
    border-radius: var(--sb-radius-card);
    display: flex;
    height: 380px;
    padding-block: var(--sb-space-64);
    padding-inline: var(--sb-space-64);
    width: 100%;
  }

  .sb-framing-card__content {
    display: flex;
    flex-direction: column;
    gap: var(--sb-space-20);
    margin-inline: 0;
    max-width: 560px;
    text-align: center;
    width: 100%;
  }

  .sb-framing-card__content h2,
  .sb-framing-card__content p {
    color: var(--sb-color-neutral-900);
    margin: 0;
  }

  .sb-framing-card__button {
    margin-inline: auto;
    margin-top: var(--sb-space-4);
    width: fit-content;
  }

  .sb-framing-card__app-downloads {
    align-items: center;
    display: flex;
    flex-wrap: wrap;
    gap: var(--sb-space-20);
    justify-content: flex-start;
    padding-top: var(--sb-space-4);
    width: 100%;
  }

  .sb-framing-card__app-downloads-qr {
    flex: 0 0 auto;
    height: var(--sb-space-80, calc(var(--sb-space-16) * 5));
    max-height: var(--sb-space-80, calc(var(--sb-space-16) * 5));
    max-width: var(--sb-space-80, calc(var(--sb-space-16) * 5));
    min-height: var(--sb-space-80, calc(var(--sb-space-16) * 5));
    min-width: var(--sb-space-80, calc(var(--sb-space-16) * 5));
    width: var(--sb-space-80, calc(var(--sb-space-16) * 5));
  }

  .sb-framing-card__app-downloads-qr img {
    display: block;
    height: var(--sb-space-80, calc(var(--sb-space-16) * 5));
    max-height: var(--sb-space-80, calc(var(--sb-space-16) * 5));
    max-width: var(--sb-space-80, calc(var(--sb-space-16) * 5));
    min-height: var(--sb-space-80, calc(var(--sb-space-16) * 5));
    min-width: var(--sb-space-80, calc(var(--sb-space-16) * 5));
    object-fit: contain;
    width: var(--sb-space-80, calc(var(--sb-space-16) * 5));
  }

  .sb-framing-card__app-download-link {
    display: inline-flex;
    flex: 0 0 auto;
    line-height: 0;
    text-decoration: none;
    transition: none;
    user-select: none;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
  }

  .sb-framing-card__app-download-badge {
    display: block;
    height: var(--sb-space-36);
    user-select: none;
    width: auto;
    -webkit-user-drag: none;
    -webkit-user-select: none;
  }

  .sb-framing-card__app-download-badge--app-store {
    aspect-ratio: 108 / 36;
  }

  .sb-framing-card__app-download-badge--google-play {
    aspect-ratio: 122 / 36;
  }

  .sb-framing-card__app-download-badge--china {
    aspect-ratio: 122 / 36;
  }

  .sb-framing-card__app-download-link[href]:hover,
  .sb-framing-card__app-download-link[href]:focus-visible {
    opacity: 0.75;
  }

  @media (max-width: 749px) {
    .sb-framing-card__app-downloads-qr {
      display: none;
    }

    .sb-framing-card__app-downloads {
      justify-content: center;
    }
  }

  @media (min-width: 750px) {
    .sb-framing-card {
      align-items: center;
      background-image: var(--sb-hero-card-bg-desktop);
      background-position: var(--sb-hero-bg-focus-desktop) center;
    }

    .sb-framing-card__content {
      text-align: left;
    }

    .sb-framing-card__button {
      margin-inline: 0;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Hero card",
  "settings": [
    {
      "type": "checkbox",
      "id": "use_seasonal_hero_card",
      "label": "Use seasonal hero card",
      "default": false
    },
    {
      "type": "image_picker",
      "id": "background_image_desktop",
      "label": "Background image desktop",
      "info": "Target minimum 1240x380 at 2x export (2480x760).",
      "visible_if": "{{ section.settings.use_seasonal_hero_card == false }}"
    },
    {
      "type": "image_picker",
      "id": "background_image_mobile",
      "label": "Background image mobile",
      "info": "Target minimum 402x380 at 3x export (1206x1140).",
      "visible_if": "{{ section.settings.use_seasonal_hero_card == false }}"
    },
    {
      "type": "text",
      "id": "kicker",
      "label": "Kicker",
      "visible_if": "{{ section.settings.use_seasonal_hero_card == false }}"
    },
    {
      "type": "textarea",
      "id": "headline",
      "label": "Headline",
      "visible_if": "{{ section.settings.use_seasonal_hero_card == false }}"
    },
    {
      "type": "textarea",
      "id": "subheadline",
      "label": "Subheadline",
      "visible_if": "{{ section.settings.use_seasonal_hero_card == false }}"
    },
    {
      "type": "checkbox",
      "id": "show_button",
      "label": "Show button",
      "default": false,
      "visible_if": "{{ section.settings.use_seasonal_hero_card == false }}"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button label",
      "default": "Placeholder",
      "visible_if": "{{ section.settings.use_seasonal_hero_card == false and section.settings.show_button }}"
    },
    {
      "type": "select",
      "id": "button_size",
      "label": "Button size",
      "default": "large",
      "options": [
        { "value": "large", "label": "Large" },
        { "value": "medium", "label": "Medium" }
      ],
      "visible_if": "{{ section.settings.use_seasonal_hero_card == false and section.settings.show_button }}"
    },
    {
      "type": "select",
      "id": "icon_position",
      "label": "Icon position",
      "default": "none",
      "options": [
        { "value": "none", "label": "None" },
        { "value": "leading", "label": "Leading" },
        { "value": "trailing", "label": "Trailing" }
      ],
      "visible_if": "{{ section.settings.use_seasonal_hero_card == false and section.settings.show_button }}"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button link",
      "visible_if": "{{ section.settings.use_seasonal_hero_card == false and section.settings.show_button }}"
    },
    {
      "type": "checkbox",
      "id": "enable_app_download_buttons",
      "label": "Enable app download buttons",
      "default": false
    }
  ],
  "presets": [
    {
      "name": "Hero card"
    }
  ]
}
{% endschema %}
